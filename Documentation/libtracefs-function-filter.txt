libtracefs(3)
=============

NAME
----
tracefs_function_filter - Function to limit kernel functions that are traced

SYNOPSIS
--------
[verse]
--
*#include <tracefs.h>*

int *tracefs_function_filter*(struct tracefs_instance pass:[*]_instance_, const char pass:[*]pass:[*]_filters_, const char pass:[*]_module_, int _flags_, const char pass:[*]pass:[*]pass:[*]_errs_);
--

DESCRIPTION
-----------
This function can be used to limit the Linux kernel functions that were
traced by the function and function-graph tracers

It will take
_instance_ , that can be NULL for the top level tracing.
_filters_, which is an array of the strings that represent a list of filters that should
be applied to define what functions are to be traced and The array must end
with a NULL pointer.
_module_ , name of the module to be traced (or NULL for all functions),
_flags_ which holds control knobs on how the filters will be handled (see *FLAGS*)
section below,
_errs_, is a pointer to an array of strings, which will be allocated if
any of filters fail to match any available function, If _errs_ is NULL, it will
be ignored.

A filter in the array of _filters_ may be either a straight match of a
function, a glob or regex(3). a glob is where 'pass:[*]' matches zero or more
characters, '?' will match zero or one character, and '.' only matches a
period. If the filter is determined to be a regex (where it contains
anything other than alpha numeric characters, or '.', 'pass:[*]', '?') the filter
will be processed as a regex(3) following the rules of regex(3), and '.' is
not a period, but will match any one character. To force a regular
expression, either prefix the filter with a '^' or append it with a '$' as
all filters will act as complete matches of functions anyway.

returns 0  on success, 1 or -x (where x is an integer) on error.

FLAGS
-----

The _flags_ parameter may have the following set, or be zero.

*TRACEFS_FL_RESET* :
If _flags_ contains *TRACEFS_FL_RESET*, then it will clear the filters that
are currently set before applying the list of filters from _filters_. Otherwise,
the list of filters from _filters_ will be added to the current set of filters
already enabled.

RETURN VALUE
------------
return 0 on success, if there is error, it will return 1 for general errors or
negative number -x(x denotes number of failed filters), if there are any failed filters.

In case of negative return value, errs have to be checked and must be freed
using the free()

EXAMPLE
-------
[source,c]
--
#include <tracefs.h>

#define INST "dummy"

const char *filters[] = { "run_init_process", "try_to_run_init_process", "dummy1", NULL };

int main(int argc, char *argv[])
{
	struct tracefs_instance *inst = tracefs_instance_create(INST);
	const char **errs = NULL;
	int flags = TRACEFS_FL_RESET;
	int ret;
	int i = 0;

	if (!inst) {
		/* Error creating new trace instance */
	}

	ret = tracefs_function_filter(inst, filters, NULL, flags, &errs);

	if (ret < 0 && errs) {
		while (errs[i])
			printf("%s\n", errs[i++]);
	}

	tracefs_instance_destroy(inst);
	free(errs);
	return 0;
}
--

FILES
-----
[verse]
--
*tracefs.h*
	Header file to include in order to have access to the library APIs.
*-ltracefs*
	Linker switch to add when building a program that uses the library.
--

SEE ALSO
--------
_libtracefs(3)_,
_libtraceevent(3)_,
_trace-cmd(1)_

AUTHOR
------
[verse]
--
*Steven Rostedt* <rostedt@goodmis.org>
*Tzvetomir Stoyanov* <tz.stoyanov@gmail.com>
*sameeruddin shaik* <sameeruddin.shaik8@gmail.com>
--
REPORTING BUGS
--------------
Report bugs to  <linux-trace-devel@vger.kernel.org>

LICENSE
-------
libtracefs is Free Software licensed under the GNU LGPL 2.1

RESOURCES
---------
https://git.kernel.org/pub/scm/libs/libtrace/libtracefs.git/

COPYING
-------
Copyright \(C) 2020 VMware, Inc. Free use of this software is granted under
the terms of the GNU Public License (GPL).
